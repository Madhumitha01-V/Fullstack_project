<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <title>Shopping Cart - Perfumy</title>
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <div class="logo">
                <h1>Perfumy</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#products">Products</a></li>
                <li><a href="index.html#about">About Us</a></li>
                <li><a href="index.html#contact">Contact</a></li>
            </ul>
            <div class="user-actions" id="userActions">
                <a href="#" class="cart-icon" id="cartIcon" title="Shopping Cart">
                    <span class="icon">üõí</span>
                    <span class="cart-count" id="cartCount">0</span>
                </a>
                <div class="user-account">
                    <button class="account-btn" id="accountBtn">
                        <span class="icon">üë§</span>
                        <span class="username" id="username">Account</span>
                    </button>
                    <div class="account-dropdown" id="accountDropdown">
                        <a href="account.html">My Account</a>
                        <a href="cart.html">My Cart</a>
                        <a href="#" id="logoutBtn">Logout</a>
                    </div>
                </div>
            </div>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>

    <section class="cart-section">
        <div class="container">
            <h1>üõí My Shopping Cart</h1>

            <div class="cart-content">
                <div class="cart-items" id="cartItems">
                    <!-- Cart items will be populated by JavaScript -->
                    <div class="empty-cart" id="emptyCart">
                        <div class="empty-cart-icon">üõí</div>
                        <h3>Your cart is empty</h3>
                        <p>Add some beautiful fragrances to your cart!</p>
                        <a href="index.html#products" class="shop-now-btn">Shop Now</a>
                    </div>
                </div>

                <div class="cart-summary" id="cartSummary" style="display: none;">
                    <h3>Order Summary</h3>
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">‚Çπ0</span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping:</span>
                        <span id="shipping">‚Çπ0</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total:</span>
                        <span id="total">‚Çπ0</span>
                    </div>
                    <button class="checkout-btn" id="checkoutBtn">
                        <span class="btn-icon">üí≥</span>
                        Proceed to Checkout
                    </button>
                    <a href="index.html#products" class="continue-shopping">Continue Shopping</a>
                </div>
            </div>
        </div>
    </section>

    <script src="script.js"></script>
    <script>
        // Cart page specific functionality
        document.addEventListener('DOMContentLoaded', function() {
            initializeUserState();
            loadCartItems();
            setupCartEventListeners();
        });

        function loadCartItems() {
            const cart = JSON.parse(localStorage.getItem('perfumy_cart') || '[]');
            const cartItemsContainer = document.getElementById('cartItems');
            const cartSummary = document.getElementById('cartSummary');
            const emptyCart = document.getElementById('emptyCart');

            if (cart.length === 0) {
                emptyCart.style.display = 'block';
                cartSummary.style.display = 'none';
                return;
            }

            emptyCart.style.display = 'none';
            cartSummary.style.display = 'block';

            // Clear existing items
            const existingItems = cartItemsContainer.querySelectorAll('.cart-item');
            existingItems.forEach(item => item.remove());

            let subtotal = 0;

            cart.forEach(item => {
                const itemElement = createCartItemElement(item);
                cartItemsContainer.insertBefore(itemElement, cartSummary);
                subtotal += item.price * item.quantity;
            });

            updateCartSummary(subtotal);
        }

        function createCartItemElement(item) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'cart-item';
            itemDiv.innerHTML = `
                <div class="cart-item-image">
                    <img src="${item.image}" alt="${item.name}">
                </div>
                <div class="cart-item-details">
                    <h4>${item.name}</h4>
                    <p class="cart-item-description">${item.description}</p>
                    <div class="cart-item-price">‚Çπ${item.price.toLocaleString()}</div>
                    <div class="quantity-controls">
                        <button class="quantity-btn minus" data-product-id="${item.id}">-</button>
                        <span class="quantity">${item.quantity}</span>
                        <button class="quantity-btn plus" data-product-id="${item.id}">+</button>
                    </div>
                </div>
                <div class="cart-item-total">‚Çπ${(item.price * item.quantity).toLocaleString()}</div>
                <button class="remove-item" data-product-id="${item.id}">
                    <span class="remove-icon">üóëÔ∏è</span>
                </button>
            `;
            return itemDiv;
        }

        function updateCartSummary(subtotal) {
            const shipping = subtotal > 500 ? 0 : 100;
            const total = subtotal + shipping;

            document.getElementById('subtotal').textContent = `‚Çπ${subtotal.toLocaleString()}`;
            document.getElementById('shipping').textContent = shipping === 0 ? 'Free' : `‚Çπ${shipping}`;
            document.getElementById('total').textContent = `‚Çπ${total.toLocaleString()}`;
        }

        function setupCartEventListeners() {
            // Quantity controls
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('quantity-btn')) {
                    const productId = parseInt(e.target.dataset.productId);
                    const isPlus = e.target.classList.contains('plus');
                    updateItemQuantity(productId, isPlus);
                }

                if (e.target.classList.contains('remove-item') || e.target.closest('.remove-item')) {
                    const productId = parseInt(e.target.dataset.productId || e.target.closest('.remove-item').dataset.productId);
                    removeFromCart(productId);
                }
            });

            // Checkout button
            document.getElementById('checkoutBtn').addEventListener('click', function() {
                alert('Checkout functionality will be implemented with payment integration!');
            });
        }

        function updateItemQuantity(productId, increase) {
            const cart = JSON.parse(localStorage.getItem('perfumy_cart') || '[]');
            const itemIndex = cart.findIndex(item => item.id === productId);

            if (itemIndex !== -1) {
                if (increase) {
                    cart[itemIndex].quantity += 1;
                } else {
                    cart[itemIndex].quantity -= 1;
                    if (cart[itemIndex].quantity <= 0) {
                        cart.splice(itemIndex, 1);
                    }
                }

                localStorage.setItem('perfumy_cart', JSON.stringify(cart));
                updateCartCount();
                loadCartItems();
            }
        }

        function removeFromCart(productId) {
            const cart = JSON.parse(localStorage.getItem('perfumy_cart') || '[]');
            const updatedCart = cart.filter(item => item.id !== productId);
            localStorage.setItem('perfumy_cart', JSON.stringify(updatedCart));
            updateCartCount();
            loadCartItems();
        }
    </script>
</body>
</html>